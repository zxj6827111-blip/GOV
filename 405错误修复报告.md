# 405 Method Not Allowed 错误修复报告

## 🚨 问题描述
用户上传PDF文件进行AI分析时遇到"405 Method Not Allowed"错误。

## 🔍 根本原因
在`engine/rules_v33.py`第1095行，代码直接使用基础URL调用AI服务：
- **错误请求**: `POST http://127.0.0.1:9009/` (根路径)
- **正确端点**: `POST http://127.0.0.1:9009/ai/extract/v1`

## 🔧 修复方案
修改URL构建逻辑，确保使用正确的API端点：

```python
# 修复前
ai_extractor_url = os.getenv("AI_EXTRACTOR_URL", "http://127.0.0.1:9009")

# 修复后  
ai_extractor_base_url = os.getenv("AI_EXTRACTOR_URL", "http://127.0.0.1:9009")
ai_extractor_url = f"{ai_extractor_base_url.rstrip('/')}/ai/extract/v1"
```

## ✅ 修复验证
完整流程测试结果：
- ✅ AI服务调用正常 (0ms响应)
- ✅ 规则检测正常 (2ms)  
- ✅ 总体流程完成 (137ms)
- ✅ 双模式检测工作正常

## 🎯 修复状态
- **修复时间**: 2025-09-24 19:30
- **修复状态**: ✅ 完成
- **用户影响**: 🎉 AI检测功能完全恢复